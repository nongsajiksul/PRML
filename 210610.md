# Exercise 1.7.

### *알아야 할 것

###### 다변수 함수의 Chain Rule

![image-20210610172639876](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610172639876.png)에 대해![image-20210610172658142](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610172658142.png)이고, ![image-20210610172726520](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610172726520.png)모두 미분 가능한 함수이면

![image-20210610172435708](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610172435708.png)

![image-20210610172555682](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610172555682.png)

이 성립한다.

본 문제에서는 아래와 같은 형태가 된다.

![image-20210610174221526](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610174221526.png)

###### Jacobian Matrix

![image-20210610172513527](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610172513527.png)

본 문제에서는 ![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?x%20%3D%20rcos%5CTheta%2C%20y%20%3D%20rsin%5CTheta)이고 ![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?dxdy%20%3D%20r%20drd%5Ctheta)가 된다.

###### 지수함수 적분

![{\displaystyle \int f'(x)e^{f(x)}\,dx=e^{f(x)}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/86148a16ca8ad7f5d0a3e8ce91a6cea111382382)



![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?I)가 문제에 나와 있는 대로 증명이 되면 실제 가우시안 분포 식에 대입만 하면 간단하게 끝난다.

# Excercise 1.11.

### *알아야 할 것

###### 로그 함수 미분법



실제로 편미분 해보면 간단하게 끝난다.



2 Probability Distributions

변수 x에 대해 확률 p(x)를 모델링을 해보자. (=Density Estimation)

2.1 Binary Variables

동전 던지기를 생각해보자.

앞면을 1로 놓고 앞면이 나올 확률이 ![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?%5Cmu)라고 했을 때![image-20210610180609547](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610180609547.png)로 정리 가능하다.

여기서 우리는 베르누이 분포를 만들어낼 수 있다.

![image-20210610180725824](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610180725824.png)

해당 분포의 평균과 분산은 다음과 같다.

![image-20210610180753302](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610180753302.png)

해당 분포의 Likelihood Function은 다음과 같다.

![image-20210610181002700](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181002700.png)

![image-20210610181015543](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181015543.png)

즉, 앞면(1)이 나온 수를 전체 시행 수로 나누어 주면 추정값을 계산할 수 있다.



이항 분포는 베르누이 분포에 추가로 시행 횟수를 Parameter로 받는다는 차이점이 존재한다.

![image-20210610181319896](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181319896.png)

![image-20210610181347114](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181347114.png)

2.1.1 The beta distribution

샘플 결과 값만 가지고 모수를 추정하면 과적합 가능성이 존재하므로,

사전 확률(Prior)을 고려하여 Smoothing을 해주려 한다.



결국 사후 분포(Posterior)를 최대화 하는 것이 목표인데 이는 사전 확률과 Likelihood Function의 곱에 비례하므로 이를 최대화 하면 된다.

Likelihood Function이 이항 분포일 경우 사전 확률로 베타 분포를 사용하면 사후 확률도 베타 분포가 되는데



베타 분포 식은 다음과 같다.

![image-20210610181652595](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181652595.png)

![image-20210610181643559](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181643559.png)

![image-20210610181735756](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181735756.png)



주목해봐야 할 것은 모수의 사전 분포를 베타 분포로 사용하면 사후 분포도 베타 분포가 된다는 점이다.

![image-20210610181833354](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610181833354.png)

이를 활용하면 관찰된 값으로 나온 사후 분포를 다시 사전 분포로 활용할 수 있고 이를 Sequential Approach to Learning 이라고 한다.

2.2 Multinomial Variables

이제 동전이 아니라 주사위 중 한 면만 1이고 나머지는 0인 것처럼 여러 가능성 중 하나를 선택하는 상황을 생각해보자.

확률은 다음과 같이 정의 가능하다.

![image-20210610182527913](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610182527913.png)

![image-20210610182431518](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610182431518.png)

![image-20210610182538563](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610182538563.png)

Likelihood Function은 다음과 같이 정의된다.

![image-20210610182557838](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610182557838.png)

![image-20210610184906008](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610184906008.png)

즉, ![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?m_%7Bk%7D)는 실제로 어떤 사건 (=![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?x_%7Bk%7D))이 발생한 횟수로 볼 수 있고 확률은 각각 ![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?%5Cmu%20_%7Bk%7D)인 경우로 생각 가능하다.

그리고 계산해보면 이항 분포와 마찬가지로

![image-20210610185008968](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610185008968.png)

을 얻을 수 있다.

이들의 결합 분포를 통해 다항 분포를 구할 수 있다.

![image-20210610185119181](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610185119181.png)

즉, N번의 시행에서 k번째 값이 ![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?m_%7Bk%7D)회 나타날 확률이라고 할 수 있다.

2.2.1 The Dirichlet distribution

다항 분포를 설명하기 좋은 분포인 Dirichlet Dist. 를 알아보자.

이항 분포에서 베타 분포를 사전 분포로 사용하듯, 다항 분포에서는 Dirichlet Dist. 를 사전 분포로 활용하여 공액화 시킨다.

사전 분포는 다음과 같은 형태로 생각하면 된다.

![image-20210610191055583](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610191055583.png)

Dirichlet Dist. 는 다음과 같다.

![image-20210610191226773](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610191226773.png)

![image-20210610191153376](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610191153376.png)

![image-20210610191248493](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610191248493.png)

해당 분포의 Likelihood Function은 다음과 같다.

![image-20210610191418184](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610191418184.png)

![image-20210610191429150](C:\Users\jinha\AppData\Roaming\Typora\typora-user-images\image-20210610191429150.png)

#![This is the rendered form of the equation. You can not edit this directly. Right click will give you the option to save the image, and in most browsers you can drag the image onto your desktop or another program.](https://latex.codecogs.com/gif.latex?%5Calpha%20_%7Bk%7D%20%3D%201)이면 평면 공간이더라.
